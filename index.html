<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Interactive Guide to Oblivion Remastered</title>
    <!-- Chosen Palette: Warm Stone & Muted Gold -->
    <!-- Application Structure Plan: A task-oriented, tabbed single-page application. This structure was chosen over a linear document to better serve player needs. Users often look for specific information (e.g., best weapons, how to level a skill) rather than reading a guide from start to finish. The tabbed navigation ('Welcome', 'Character Guide', 'Legendary Gear', 'Exploits & Secrets', 'The Scribe\'s Wisdom') allows for immediate access to key topics. The 'Character Guide' logically groups starting-player information (leveling, builds, tips). 'Legendary Gear' gets a dedicated, filterable section as it's a high-interest topic. 'Exploits' are separated to respect player choice. 'The Scribe\'s Wisdom' provides an LLM-powered interactive Q&A. This non-linear, task-based architecture dramatically improves usability and speed of information retrieval compared to the source report's format. -->
    <!-- Visualization & Content Choices: 
        - Report Info: Leveling System / Virtue Points -> Goal: Inform/Compare -> Viz: Bar Chart (Chart.js) -> Interaction: Hover Tooltips -> Justification: Visually communicates the high cost of the 'Luck' attribute far more effectively than a table. Confirms NO SVG/Mermaid.
        - Report Info: Character Builds -> Goal: Compare -> Viz: 3-Column Card Layout (HTML/Tailwind) -> Interaction: None -> Justification: Provides a clear, at-a-glance comparison of the core archetypes (Melee, Mage, Stealth), aiding player choice. Confirms NO SVG/Mermaid.
        - Report Info: Unique Weapons/Armor -> Goal: Organize/Filter -> Viz: Interactive Card Gallery (HTML/Tailwind/JS) -> Interaction: Clickable filter buttons (All, Weapon, Armor, etc.) -> Justification: Transforms a static list into a powerful tool, allowing users to find specific gear types quickly. Confirms NO SVG/Mermaid.
        - Report Info: Game Exploits -> Goal: Organize/Hide -> Viz: Accordion Toggles (HTML/Tailwind/JS) -> Interaction: Click to expand/collapse -> Justification: Prevents information overload and accidental spoilers. Makes the section cleaner and respects user intent to view potentially game-altering information. Confirms NO SVG/Mermaid.
        - Report Info: General Lore/Strategy -> Goal: Answer Open-ended Questions -> Viz: Text Input/Output Area (HTML/Tailwind/JS) -> Interaction: User types question, clicks button, LLM generates answer -> Justification: Leverages the Gemini API to provide dynamic, context-aware responses to user queries, greatly enhancing the guide's utility beyond static information. Confirms NO SVG/Mermaid.
     -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Georgia', serif;
            background-color: #f5f5f4; /* stone-100 */
        }
        .nav-link {
            transition: color 0.3s, border-color 0.3s;
        }
        .nav-link.active {
            color: #d97706; /* amber-600 */
            border-bottom-color: #d97706; /* amber-600 */
        }
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
        }
        .accordion-content {
            display: none;
        }
        .chart-container {
            position: relative;
            margin: auto;
            height: 40vh;
            width: 100%;
            max-width: 800px;
            max-height: 400px;
        }
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #d97706; /* amber-600 */
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
            display: none; /* Hidden by default */
            margin: 0 auto;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-stone-100 text-stone-800">

    <div class="container mx-auto p-4 md:p-8 max-w-7xl">
        
        <header class="text-center mb-8">
            <h1 class="text-4xl md:text-5xl font-bold text-stone-900 tracking-wider">The Elder Scrolls IV: Oblivion Remastered</h1>
            <p class="text-lg text-stone-600 mt-2">Your Interactive Guide to Cyrodiil</p>
        </header>

        <nav id="main-nav" class="sticky top-0 bg-stone-100/80 backdrop-blur-sm z-10 mb-8 border-b-2 border-stone-300">
            <ul class="flex justify-center space-x-4 md:space-x-8 text-sm md:text-lg font-semibold">
                <li><a href="#" data-tab="welcome" class="nav-link active py-4 block border-b-4 border-transparent hover:text-amber-600">Welcome</a></li>
                <li><a href="#" data-tab="character" class="nav-link py-4 block border-b-4 border-transparent hover:text-amber-600">Character Guide</a></li>
                <li><a href="#" data-tab="gear" class="nav-link py-4 block border-b-4 border-transparent hover:text-amber-600">Legendary Gear</a></li>
                <li><a href="#" data-tab="exploits" class="nav-link py-4 block border-b-4 border-transparent hover:text-amber-600">Exploits & Secrets</a></li>
                <li><a href="#" data-tab="scribe" class="nav-link py-4 block border-b-4 border-transparent hover:text-amber-600">The Scribe's Wisdom</a></li>
            </ul>
        </nav>

        <main>
            <!-- Welcome Section -->
            <section id="welcome" class="content-section active space-y-6">
                <div class="p-6 bg-white rounded-lg shadow-md">
                    <h2 class="text-3xl font-bold mb-4 text-amber-700 border-b pb-2">A Modern Return to Cyrodiil</h2>
                    <p class="text-base leading-relaxed">
                        This guide is your essential companion for *The Elder Scrolls IV: Oblivion Remastered*. The game represents a significant modernization of the 2006 classic, blending its iconic open-world experience with a breathtaking new look powered by Unreal Engine 5. While visually remade from the ground up, the remaster preserves the core Gamebryo engine logic, meaning the fundamental gameplay, physics, and even some classic quirks remain. This application is designed to help both veterans and newcomers navigate the vast world of Cyrodiil, providing curated tips, build advice, gear locations, and a look into the game's most useful exploits.
                    </p>
                    <p class="text-base leading-relaxed mt-4">
                        Use the navigation tabs above to explore different facets of the game. The 'Character Guide' will help you start your journey, 'Legendary Gear' provides a filterable database of the best items, and 'Exploits & Secrets' reveals powerful, unintended mechanics. This interactive format allows you to quickly find the information you need to master your adventure.
                    </p>
                </div>
            </section>

            <!-- Character Guide Section -->
            <section id="character" class="content-section space-y-8">
                <div class="p-6 bg-white rounded-lg shadow-md">
                    <h2 class="text-3xl font-bold mb-4 text-amber-700 border-b pb-2">Crafting Your Hero</h2>
                    <p class="text-base leading-relaxed mb-6">
                        Building an effective character is the cornerstone of your adventure in Cyrodiil. This section provides a comprehensive overview of the remastered leveling system, offers guidance on creating powerful character builds, and shares essential tips for a smooth start. The new 'Virtue Point' system frees you from the strict "efficient leveling" of the original, giving you more freedom to develop your character as you see fit.
                    </p>
                    
                    <h3 class="text-2xl font-semibold mb-4">The New Leveling System: Virtue Points</h3>
                    <p class="text-base leading-relaxed mb-4">Upon leveling up, you receive 12 "Virtue Points" to distribute among your attributes. You can increase a maximum of three attributes, with each point costing 1 Virtue Point, except for Luck, which costs 4. This chart visualizes the cost, highlighting Luck's expense.</p>
                    <div class="chart-container">
                        <canvas id="attributeChart"></canvas>
                    </div>

                    <h3 class="text-2xl font-semibold mt-8 mb-4">Recommended Character Builds</h3>
                    <p class="text-base leading-relaxed mb-6">While you can create any character you wish, these archetypes provide a solid foundation for three major playstyles. Creating a custom class is highly recommended to tailor these to your preference.</p>
                    <div class="grid md:grid-cols-3 gap-6">
                        <!-- Melee Build -->
                        <div class="border border-stone-200 rounded-lg p-4 bg-stone-50">
                            <h4 class="text-xl font-bold text-center mb-2">‚öîÔ∏è The Warrior</h4>
                            <p class="text-sm text-center text-stone-600 mb-4">Dominates the battlefield with brute force and resilience.</p>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Primary Attributes:</strong> Strength, Endurance</li>
                                <li><strong>Recommended Races:</strong> Orc, Redguard, Nord</li>
                                <li><strong>Recommended Birthsign:</strong> The Warrior, The Lady</li>
                                <li><strong>Core Skills:</strong> Heavy Armor, Blade/Blunt, Block, Armorer</li>
                                <li><strong>Support Skills:</strong> Restoration, Alchemy</li>
                            </ul>
                        </div>
                        <!-- Mage Build -->
                        <div class="border border-stone-200 rounded-lg p-4 bg-stone-50">
                            <h4 class="text-xl font-bold text-center mb-2">üßô The Mage</h4>
                            <p class="text-sm text-center text-stone-600 mb-4">Commands powerful magic to destroy foes and control the environment.</p>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Primary Attributes:</strong> Intelligence, Willpower</li>
                                <li><strong>Recommended Races:</strong> Breton, High Elf (Altmer)</li>
                                <li><strong>Recommended Birthsign:</strong> The Mage, The Atronach (Advanced)</li>
                                <li><strong>Core Skills:</strong> Destruction, Conjuration, Restoration</li>
                                <li><strong>Support Skills:</strong> Alchemy, Illusion, Alteration</li>
                            </ul>
                        </div>
                        <!-- Stealth Build -->
                        <div class="border border-stone-200 rounded-lg p-4 bg-stone-50">
                            <h4 class="text-xl font-bold text-center mb-2">üèπ The Agent</h4>
                            <p class="text-sm text-center text-stone-600 mb-4">Strikes from the shadows, relying on cunning and precision.</p>
                            <ul class="space-y-2 text-sm">
                                <li><strong>Primary Attributes:</strong> Agility, Speed</li>
                                <li><strong>Recommended Races:</strong> Wood Elf (Bosmer), Khajiit</li>
                                <li><strong>Recommended Birthsign:</strong> The Thief, The Shadow</li>
                                <li><strong>Core Skills:</b> Sneak, Marksman, Light Armor, Security</li>
                                <li><strong>Support Skills:</strong> Alchemy (Poisons), Illusion</li>
                            </ul>
                        </div>
                    </div>
                    
                    <!-- NEW Gemini Feature: Character Build Oracle -->
                    <div class="mt-10 pt-6 border-t border-stone-300">
                        <h3 class="text-3xl font-bold mb-4 text-amber-700">The Character Build Oracle ‚ú®</h3>
                         <p class="text-base leading-relaxed mb-6">
                            Unsure where to start? Describe your desired fantasy or playstyle to the Oracle, and it will forge a unique character build for you, complete with recommended race, birthsign, attributes, and major skills.
                        </p>
                        <div class="flex flex-col space-y-4">
                            <textarea id="build-description" class="w-full p-3 border border-stone-300 rounded-lg focus:ring-amber-500 focus:border-amber-500" rows="4" placeholder="e.g., 'I want to be a charismatic knight who uses illusion spells to charm people and a big axe to crush my enemies.'"></textarea>
                            <button id="ask-oracle-btn" class="bg-amber-600 text-white py-3 px-6 rounded-lg font-bold text-lg hover:bg-amber-700 transition-colors flex items-center justify-center gap-2">
                                Consult the Oracle ‚ú®
                                <div id="oracle-spinner" class="spinner"></div>
                            </button>
                            <div id="oracle-response" class="mt-4 p-4 bg-stone-50 border border-stone-200 rounded-lg min-h-[100px] text-stone-800 leading-relaxed">
                                Awaiting your vision...
                            </div>
                        </div>
                    </div>

                </div>
            </section>
            
            <!-- Legendary Gear Section -->
            <section id="gear" class="content-section space-y-6">
                 <div class="p-6 bg-white rounded-lg shadow-md">
                    <h2 class="text-3xl font-bold mb-4 text-amber-700 border-b pb-2">Armory of Legends</h2>
                    <p class="text-base leading-relaxed mb-6">
                        Cyrodiil is home to powerful artifacts and legendary equipment. While most gear scales with your level, certain unique items offer unmatched power and can be acquired at any time. This section serves as an interactive database of the most notable weapons and armor sets in the game. Use the filters below to find the gear that best suits your character's needs. High-tier generic items like Daedric and Glass begin appearing around level 20.
                    </p>
                    <div id="gear-filters" class="flex flex-wrap justify-center gap-2 mb-8">
                        <button data-filter="all" class="gear-filter-btn bg-amber-600 text-white py-2 px-4 rounded-lg font-semibold transition-colors">All</button>
                        <button data-filter="weapon" class="gear-filter-btn bg-stone-200 hover:bg-amber-500 hover:text-white py-2 px-4 rounded-lg font-semibold transition-colors">Weapons</button>
                        <button data-filter="armor" class="gear-filter-btn bg-stone-200 hover:bg-amber-500 hover:text-white py-2 px-4 rounded-lg font-semibold transition-colors">Armor</button>
                        <button data-filter="jewelry" class="gear-filter-btn bg-stone-200 hover:bg-amber-500 hover:text-white py-2 px-4 rounded-lg font-semibold transition-colors">Jewelry & Staves</button>
                    </div>

                    <div id="gear-grid" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Gear Items will be dynamically populated here by JS, but are hardcoded for this example -->
                        <div class="gear-item border border-stone-200 rounded-lg p-4 flex flex-col" data-category="weapon">
                            <h4 class="text-xl font-bold mb-1">Umbra Sword</h4>
                            <span class="text-xs font-semibold uppercase text-amber-700 mb-2">One-Handed Sword</span>
                            <p class="text-sm text-stone-600 flex-grow">One of the best swords in the game. High base damage with a Soul Trap enchantment.</p>
                            <p class="text-sm mt-3 font-semibold">Location: Defeat Umbra in the Ayleid Ruin of Vindasel.</p>
                        </div>
                        <div class="gear-item border border-stone-200 rounded-lg p-4 flex flex-col" data-category="weapon">
                            <h4 class="text-xl font-bold mb-1">Goldbrand</h4>
                            <span class="text-xs font-semibold uppercase text-amber-700 mb-2">Katana</span>
                            <p class="text-sm text-stone-600 flex-grow">A Daedric artifact with high damage and a powerful Fire Damage enchantment.</p>
                            <p class="text-sm mt-3 font-semibold">Location: Reward from Boethiah's Daedric quest (Level 20+).</p>
                        </div>
                        <div class="gear-item border border-stone-200 rounded-lg p-4 flex flex-col" data-category="armor">
                            <h4 class="text-xl font-bold mb-1">Crusader's Relics</h4>
                            <span class="text-xs font-semibold uppercase text-amber-700 mb-2">Heavy Armor Set</span>
                            <p class="text-sm text-stone-600 flex-grow">Powerful leveled set. Wearing all pieces grants a "Holy Aura" shield. Can be re-leveled on a mannequin.</p>
                            <p class="text-sm mt-3 font-semibold">Location: Complete the Knights of the Nine questline.</p>
                        </div>
                        <div class="gear-item border border-stone-200 rounded-lg p-4 flex flex-col" data-category="armor">
                            <h4 class="text-xl font-bold mb-1">Daedric Armor</h4>
                            <span class="text-xs font-semibold uppercase text-amber-700 mb-2">Heavy Armor Set (Generic)</span>
                            <p class="text-sm text-stone-600 flex-grow">The highest tier of generic heavy armor. Begins appearing as loot at Level 20+.</p>
                            <p class="text-sm mt-3 font-semibold">Location: Farm Marauders at Rockmilk Cave or loot from high-level enemies.</p>
                        </div>
                         <div class="gear-item border border-stone-200 rounded-lg p-4 flex flex-col" data-category="weapon">
                            <h4 class="text-xl font-bold mb-1">Frostwyrm Bow</h4>
                            <span class="text-xs font-semibold uppercase text-amber-700 mb-2">Bow</span>
                            <p class="text-sm text-stone-600 flex-grow">Unleveled bow with high frost damage. Excellent for early-game archers.</p>
                            <p class="text-sm mt-3 font-semibold">Location: Looted from the 'Uderfrykte Matron' northeast of Cyrodiil.</p>
                        </div>
                         <div class="gear-item border border-stone-200 rounded-lg p-4 flex flex-col" data-category="jewelry">
                            <h4 class="text-xl font-bold mb-1">Skeleton Key</h4>
                            <span class="text-xs font-semibold uppercase text-amber-700 mb-2">Key (Utility)</span>
                            <p class="text-sm text-stone-600 flex-grow">An unbreakable lockpick. A Daedric artifact that makes the lockpicking minigame obsolete.</p>
                            <p class="text-sm mt-3 font-semibold">Location: Reward from Nocturnal's Daedric quest.</p>
                        </div>
                        <div class="gear-item border border-stone-200 rounded-lg p-4 flex flex-col" data-category="jewelry">
                            <h4 class="text-xl font-bold mb-1">Apotheosis Staff</h4>
                            <span class="text-xs font-semibold uppercase text-amber-700 mb-2">Staff</span>
                            <p class="text-sm text-stone-600 flex-grow">An excellent unleveled staff for mages, dealing simultaneous Fire, Frost, and Shock damage.</p>
                            <p class="text-sm mt-3 font-semibold">Location: Purchase from Rindir's Staffs in the Imperial City Market District.</p>
                        </div>
                        <div class="gear-item border border-stone-200 rounded-lg p-4 flex flex-col" data-category="armor">
                            <h4 class="text-xl font-bold mb-1">Glass Armor</h4>
                            <span class="text-xs font-semibold uppercase text-amber-700 mb-2">Light Armor Set (Generic)</span>
                            <p class="text-sm text-stone-600 flex-grow">The highest tier of generic light armor. Begins appearing as loot at Level 20+.</p>
                            <p class="text-sm mt-3 font-semibold">Location: Farm Bandits and Marauders at Rockmilk Cave or loot from high-level enemies.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Exploits Section -->
            <section id="exploits" class="content-section space-y-6">
                <div class="p-6 bg-white rounded-lg shadow-md">
                    <h2 class="text-3xl font-bold mb-4 text-amber-700 border-b pb-2">Exploits & Secrets</h2>
                    <p class="text-base leading-relaxed mb-6">
                        Due to the remaster retaining the original Gamebryo engine's core, many classic exploits remain functional. These can be used to gain significant advantages, from infinite gold to rapid skill leveling. This section details the most potent confirmed exploits. Use them at your own discretion, as they can alter the intended game balance and challenge. Click on an exploit to reveal how it's performed.
                    </p>
                    <div class="space-y-4">
                        <!-- Item Duplication -->
                        <div class="accordion-item border border-stone-200 rounded-lg">
                            <button class="accordion-header w-full text-left p-4 bg-stone-50 hover:bg-stone-100 font-bold text-lg">Item Duplication (Container Method)</button>
                            <div class="accordion-content p-4 border-t border-stone-200">
                                <p>This allows for duplication of stackable items like arrows or potions.
                                <ol class="list-decimal list-inside mt-2 space-y-1">
                                    <li>Open an empty container.</li>
                                    <li>Place a single item you want to duplicate inside.</li>
                                    <li>Highlight a large stack of a DIFFERENT item (e.g., 100 arrows) in your inventory.</li>
                                    <li>Press the buttons to equip and drop simultaneously (e.g., R1 + X on PlayStation).</li>
                                    <li>Confirm twice. The item will be duplicated by the number in the stack you highlighted.</li>
                                </ol>
                                </p>
                            </div>
                        </div>
                        <!-- Max Security -->
                        <div class="accordion-item border border-stone-200 rounded-lg">
                            <button class="accordion-header w-full text-left p-4 bg-stone-50 hover:bg-stone-100 font-bold text-lg">Max Security Skill</button>
                            <div class="accordion-content p-4 border-t border-stone-200">
                                <p>Rapidly levels the Security skill to 100.
                                <ol class="list-decimal list-inside mt-2 space-y-1">
                                    <li>Find any locked container with at least one tumbler already set.</li>
                                    <li>Move your lockpick under a pin that is already locked in the "up" position.</li>
                                    <li>Repeatedly press the action button. The game will grant experience as if you are successfully setting tumblers.</li>
                                </ol>
                                </p>
                            </div>
                        </div>
                         <!-- Permanent Bound Items -->
                        <div class="accordion-item border border-stone-200 rounded-lg">
                            <button class="accordion-header w-full text-left p-4 bg-stone-50 hover:bg-stone-100 font-bold text-lg">Permanent Bound Items</button>
                            <div class="accordion-content p-4 border-t border-stone-200">
                                <p>Allows you to keep weightless bound weapons and armor forever.
                                <ol class="list-decimal list-inside mt-2 space-y-1">
                                    <li>Cast a Bound Weapon or Armor spell.</li>
                                    <li>Damage the item slightly (hit an enemy or take damage).</li>
                                    <li>Repair the item with a Repair Hammer.</li>
                                    <li>Drop the item on the ground.</li>
                                    <li>Wait for the spell timer to expire. The item will remain and can be picked up.</li>
                                </ol>
                                </p>
                            </div>
                        </div>
                        <!-- Sneak Skill -->
                        <div class="accordion-item border border-stone-200 rounded-lg">
                            <button class="accordion-header w-full text-left p-4 bg-stone-50 hover:bg-stone-100 font-bold text-lg">Max Sneak Skill</button>
                            <div class="accordion-content p-4 border-t border-stone-200">
                                <p>Effortlessly level Sneak to 100.
                                <ol class="list-decimal list-inside mt-2 space-y-1">
                                    <li>In the tutorial prison cell, crouch and walk into the wall. Your character will continuously "move," granting sneak experience.</li>
                                    <li>Alternatively, find a non-hostile NPC in a corner and continuously walk into them while sneaking.</li>
                                </ol>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- The Scribe's Wisdom Section (Gemini API Integration) -->
            <section id="scribe" class="content-section space-y-6">
                <div class="p-6 bg-white rounded-lg shadow-md">
                    <h2 class="text-3xl font-bold mb-4 text-amber-700 border-b pb-2">The Scribe's Wisdom ‚ú®</h2>
                    <p class="text-base leading-relaxed mb-6">
                        Consult the ancient Scribe for answers to your questions about Cyrodiil! Whether you seek lore, strategic advice, or general information about your adventures in Oblivion, the Scribe is here to guide you. Simply type your question below and click the button to receive wisdom.
                    </p>
                    <div class="flex flex-col space-y-4">
                        <textarea id="scribe-query" class="w-full p-3 border border-stone-300 rounded-lg focus:ring-amber-500 focus:border-amber-500" rows="5" placeholder="Ask the Scribe a question about Oblivion Remastered..."></textarea>
                        <button id="ask-scribe-btn" class="bg-amber-600 text-white py-3 px-6 rounded-lg font-bold text-lg hover:bg-amber-700 transition-colors flex items-center justify-center gap-2">
                            Ask the Scribe ‚ú®
                            <div id="scribe-spinner" class="spinner"></div>
                        </button>
                        <div id="scribe-response" class="mt-4 p-4 bg-stone-50 border border-stone-200 rounded-lg min-h-[100px] text-stone-800 leading-relaxed">
                            Awaiting your query...
                        </div>
                    </div>
                </div>
            </section>

        </main>
    </div>

<script>
document.addEventListener('DOMContentLoaded', () => {

    // Tab Navigation
    const nav = document.getElementById('main-nav');
    const navLinks = nav.querySelectorAll('a');
    const contentSections = document.querySelectorAll('.content-section');

    nav.addEventListener('click', (e) => {
        e.preventDefault();
        const link = e.target.closest('a');
        if (!link) return;

        const tab = link.dataset.tab;
        
        navLinks.forEach(l => l.classList.remove('active'));
        link.classList.add('active');

        contentSections.forEach(section => {
            section.classList.remove('active');
            if (section.id === tab) {
                section.classList.add('active');
            }
        });
    });

    // Attribute Chart
    const ctx = document.getElementById('attributeChart').getContext('2d');
    const attributeChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Strength', 'Intelligence', 'Willpower', 'Agility', 'Speed', 'Endurance', 'Personality', 'Luck'],
            datasets: [{
                label: 'Virtue Points per +1 Attribute',
                data: [1, 1, 1, 1, 1, 1, 1, 4],
                backgroundColor: [
                    'rgba(120, 113, 108, 0.6)', // stone-500
                    'rgba(120, 113, 108, 0.6)',
                    'rgba(120, 113, 108, 0.6)',
                    'rgba(120, 113, 108, 0.6)',
                    'rgba(120, 113, 108, 0.6)',
                    'rgba(120, 113, 108, 0.6)',
                    'rgba(120, 113, 108, 0.6)',
                    'rgba(217, 119, 6, 0.6)' // amber-600
                ],
                borderColor: [
                    'rgba(120, 113, 108, 1)',
                    'rgba(120, 113, 108, 1)',
                    'rgba(120, 113, 108, 1)',
                    'rgba(120, 113, 108, 1)',
                    'rgba(120, 113, 108, 1)',
                    'rgba(120, 113, 108, 1)',
                    'rgba(120, 113, 108, 1)',
                    'rgba(217, 119, 6, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: {
                        stepSize: 1
                    }
                }
            },
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    callbacks: {
                        label: function(context) {
                            let label = context.dataset.label || '';
                            if (label) {
                                label += ': ';
                            }
                            if (context.parsed.y !== null) {
                                label += context.parsed.y + ' points';
                            }
                            return label;
                        }
                    }
                }
            }
        }
    });

    // Gear Filtering
    const filterContainer = document.getElementById('gear-filters');
    const gearItems = document.querySelectorAll('.gear-item');
    const filterButtons = document.querySelectorAll('.gear-filter-btn');

    filterContainer.addEventListener('click', (e) => {
        const button = e.target.closest('button');
        if (!button) return;

        const filter = button.dataset.filter;

        filterButtons.forEach(btn => {
            btn.classList.remove('bg-amber-600', 'text-white');
            btn.classList.add('bg-stone-200');
        });
        button.classList.add('bg-amber-600', 'text-white');
        button.classList.remove('bg-stone-200');

        gearItems.forEach(item => {
            if (filter === 'all' || item.dataset.category === filter) {
                item.style.display = 'flex';
            } else {
                item.style.display = 'none';
            }
        });
    });

    // Accordion Logic
    const accordionHeaders = document.querySelectorAll('.accordion-header');
    accordionHeaders.forEach(header => {
        header.addEventListener('click', () => {
            const content = header.nextElementSibling;
            if (content.style.display === "block") {
                content.style.display = "none";
            } else {
                content.style.display = "block";
            }
        });
    });
    
    // --- Gemini API Integrations ---

    // 1. The Scribe's Wisdom (Q&A)
    const askScribeBtn = document.getElementById('ask-scribe-btn');
    const scribeQueryInput = document.getElementById('scribe-query');
    const scribeResponseDiv = document.getElementById('scribe-response');
    const scribeSpinner = document.getElementById('scribe-spinner');

    askScribeBtn.addEventListener('click', async () => {
        const prompt = scribeQueryInput.value.trim();
        if (!prompt) {
            scribeResponseDiv.textContent = 'Please enter a question for the Scribe.';
            return;
        }

        scribeResponseDiv.textContent = ''; 
        scribeSpinner.style.display = 'block'; 
        askScribeBtn.disabled = true;

        try {
            let chatHistory = [];
            // Updated prompt to be more specific and provide better context for the LLM.
            chatHistory.push({ role: "user", parts: [{ text: `You are an expert on The Elder Scrolls IV: Oblivion. Provide a helpful, detailed, and lore-friendly answer to the following player's question about the game. Question: ${prompt}` }] });
            const payload = { contents: chatHistory };
            const apiKey = ""; 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });

            const result = await response.json();

            if (result.candidates && result.candidates.length > 0 &&
                result.candidates[0].content && result.candidates[0].content.parts &&
                result.candidates[0].content.parts.length > 0) {
                const text = result.candidates[0].content.parts[0].text;
                scribeResponseDiv.textContent = text;
            } else {
                scribeResponseDiv.textContent = 'The Scribe is pondering... Please try again or rephrase your question.';
                console.error('Unexpected API response structure:', result);
            }
        } catch (error) {
            scribeResponseDiv.textContent = 'The Scribe is unable to respond right now. A disturbance in the Aetherium perhaps?';
            console.error('Error fetching from Gemini API:', error);
        } finally {
            scribeSpinner.style.display = 'none';
            askScribeBtn.disabled = false;
        }
    });


    // 2. The Character Build Oracle
    const askOracleBtn = document.getElementById('ask-oracle-btn');
    const buildDescriptionInput = document.getElementById('build-description');
    const oracleResponseDiv = document.getElementById('oracle-response');
    const oracleSpinner = document.getElementById('oracle-spinner');

    askOracleBtn.addEventListener('click', async () => {
        const description = buildDescriptionInput.value.trim();
        if (!description) {
            oracleResponseDiv.textContent = 'Please describe the character you wish to become.';
            return;
        }

        oracleResponseDiv.innerHTML = '';
        oracleSpinner.style.display = 'block';
        askOracleBtn.disabled = true;

        try {
            const prompt = `Based on the following player description for a character in The Elder Scrolls IV: Oblivion, create a detailed character build. Player description: "${description}"`;
            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            
            const payload = {
              contents: chatHistory,
              generationConfig: {
                  responseMimeType: "application/json",
                  responseSchema: {
                      type: "OBJECT",
                      properties: {
                          build_name: { type: "STRING" },
                          description: { type: "STRING" },
                          race: { type: "STRING" },
                          birthsign: { type: "STRING" },
                          primary_attributes: { 
                              type: "ARRAY",
                              items: { type: "STRING" }
                          },
                          major_skills: {
                              type: "ARRAY",
                              items: { type: "STRING" }
                          }
                      },
                      required: ["build_name", "description", "race", "birthsign", "primary_attributes", "major_skills"]
                  }
              }
            };
            
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;

            const response = await fetch(apiUrl, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
            const result = await response.json();
            
            if (result.candidates && result.candidates[0].content && result.candidates[0].content.parts[0]) {
                const jsonText = result.candidates[0].content.parts[0].text;
                const build = JSON.parse(jsonText);
                
                // Display the structured response
                oracleResponseDiv.innerHTML = `
                    <h4 class="text-xl font-bold text-center mb-2">${build.build_name || 'Custom Build'}</h4>
                    <p class="text-sm text-center text-stone-600 mb-4 italic">"${build.description || 'A build tailored to your vision.'}"</p>
                    <ul class="space-y-2 text-sm">
                        <li><strong>Recommended Race:</strong> ${build.race}</li>
                        <li><strong>Recommended Birthsign:</strong> ${build.birthsign}</li>
                        <li><strong>Primary Attributes:</strong> ${build.primary_attributes.join(', ')}</li>
                        <li><strong>Major Skills:</strong> ${build.major_skills.join(', ')}</li>
                    </ul>
                `;
            } else {
                 oracleResponseDiv.textContent = 'The Oracle could not fully grasp your vision. Please try describing it in a different way.';
                 console.error('Unexpected API response structure for Oracle:', result);
            }

        } catch (error) {
            oracleResponseDiv.textContent = 'The Oracle is clouded at the moment. Please try again later.';
            console.error('Error fetching from Gemini API for Oracle:', error);
        } finally {
            oracleSpinner.style.display = 'none';
            askOracleBtn.disabled = false;
        }
    });

});
</script>

</body>
</html>
